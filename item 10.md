# 아이템 10. 단위 테스트를 만들어라

코드를 안전하게 만드는 다양한 방법이 있지만, 사실 코드를 안전하게 만드는 가장 궁극적인 방법은 **다양한 종류의 테스트**를 하는 것입니다. 이러한 종류의 테스트는 개발자의 관점에서 애플리케이션 내부적으로 올바르게 작동하는지 확인하는 것이 아니라, 사용자의 관점에서 애플리케이션 외부적으로 제대로 작동하는지 확인하는 것이 목표입니다.일반적으로 대부분의 관리자는 이러한 테스트만 인지하고 있습니다.

이러한 테스트는 개발자에게 유용하지만 충분하지는 않습니다. 이것만으로는 해당 요소가 올바르게 작동한다는 것을 완전하게 보증할 수 없습니다. 또한 개발 시점에 빠른 피드백을 받을 수 없습니다. 이러한 문제를 해결하려면, <b>단위 테스트<small>(unit test)</small></b>가 필요합니다. 단위 테스트는 개발자가 작성하며, 개발자에게 유용합니다.

단위 테스트는 일반적으로 다음과 같은 내용을 확인합니다.

- 일반적인 Use Case<small>(이를 happy path라고도 표현)</small>
  - 요소가 사용될 거라고 예상되는 일반적인 방법을 테스트합니다
  - 예를 들어 앞의 코드처럼 함수로 간단한 숫자 몇 개를 테스트합니다.
- 일반적인 오류 케이스와 잠재적인 문제
  - 제대로 동작하지 않을 거라고 예상되는 일반적인 부분, 과거에 문제가 발생했던 부분 등을 테스트합니다.
- Edge Case와 잘못된 Argument
  - Int의 경우 *Int.Max_VALUE*를 사용하는 경우, nullable의 경우 'null' 또는 'null 값으로 채워진 객체'를 사용하는 경우를 의미합니다.
  - 또한 피보나치 수는 양의 정수로만 구할 수 있습니다. 음의 정수 등을 넣으면 아규먼트 자체가 잘못된 것입니다. 이러한 경우를 테스트할 수 있습니다.

> 회귀테스트: 기존에 누적된 테스트 케이스<small>(테스트해야하는 부분)</small>를 기반으로 전체 또는 부분을 반복적으로 테스트하는 것을 회귀 테스트<small>(regression test)</small>라고 부릅니다.

단위 테스트는 개발자가 만들고 있는 요소가 제대로 동작하는지를 빠르게 피드백해 주므로 개발하는 동안에 큰 도움이 됩니다. 테스트는 계속해서 축적되므로, 회귀 테스트도 쉽습니다.또한 수동으로 테스트하기 어려운 것들도 확인할 수 있습니다. TDD<small>(Test Driven Development)</small>라는 접근 방식도 있습니다. TDD는 개발 전에 테스트를 먼저 작성하고, 테스트를 통과시키는 것을 목적으로 하나하나 구현해 나가는 방식입니다.

효과적인 단위 테스트를 하는 방법을 습득하고, 단위 테스트를 위한 코드를 작성하는 것이 생각보다 어렵습니다. 숙련된 코틀린 개발자가 되려면, 단위 테스트와 관련된 기술을 습득하고, 중요한 코드라고 할 수 있는 다음과 같은 부분에 대해 단위 테스트하는 방법을 알고 있어야 합니다.

- 복잡한 부분
- 계속해서 수정이 일어나고 리팩터링이 일어날 수 있는 부분
- 비즈니스 로직 부분
- 공용 API 부분
- 문제가 자주 발생하는 부분
- 수정해야 하는 프로덕션 버그<small>(프로덕션 환경에서 발생하는 버그)</small>

## 정리

지금까지 프로그램이 올바르게 작동해야 한다는 것을 최우선적인 목표로 두고 여러 가지 내용을 살펴보았습니다. 이번 장에서 설명한 내용들을 활용하면, 안정적인 프로그램을 만들 수 있습니다. 하지만 **가장 중요한 것은 애플리케이션이 진짜로 올바르게 동작하는지 확인하는 것**입니다. **이것이 테스트입니다.** 테스트 중에서 개발 과정에서 가장 효율적으로 활용할 수 있는 테스트는 바로 단위 테스트이빈다. 그래서 이번 장의 마지막 부분에서 간단히 다루어 보았습니다. 비즈니스 애플리케이션 등에는 최소한 몇 개라도 단위 테스트가 꼭 필요합니다.